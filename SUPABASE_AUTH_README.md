# Supabase Authentication for Lifesprint

Это руководство описывает процесс настройки и использования аутентификации Supabase в приложении Lifesprint.

## Настройка Supabase

### 1. Создание проекта Supabase

1. Перейдите на [app.supabase.com](https://app.supabase.com) и войдите в свой аккаунт
2. Нажмите "New Project" и создайте новый проект
3. Заполните необходимые поля:
   - Name: Lifesprint
   - Database Password: (создайте надежный пароль)
   - Region: (выберите ближайший к вам регион)
4. Нажмите "Create new project"

### 2. Настройка базы данных

1. После создания проекта перейдите в раздел "SQL Editor"
2. Откройте файл `supabase-setup.sql` из корня проекта
3. Скопируйте содержимое файла и вставьте его в SQL Editor
4. Нажмите "Run" для выполнения SQL-скрипта
5. Проверьте, что таблицы `profiles` и `user_progress` созданы в разделе "Table Editor"

### 3. Настройка аутентификации

1. Перейдите в раздел "Authentication" -> "Settings"
2. В разделе "Email Auth" убедитесь, что опция "Enable Email Signup" включена
3. Настройте шаблоны писем для подтверждения email и сброса пароля (по желанию)

### 4. Получение ключей API

1. Перейдите в раздел "Settings" -> "API"
2. Скопируйте "URL" и "anon/public" ключ
3. Добавьте эти ключи в файл `.env`:
   ```
   REACT_APP_SUPABASE_URL=ваш_url
   REACT_APP_SUPABASE_ANON_KEY=ваш_ключ
   ```

## Использование аутентификации в приложении

### Регистрация и вход

Приложение теперь поддерживает регистрацию и вход через Supabase. Пользователи могут:
- Зарегистрироваться с помощью email и пароля
- Войти с помощью email и пароля
- Сбросить пароль (функция будет доступна в следующей версии)

### Миграция данных

Для пользователей, которые уже использовали приложение с локальным хранилищем (localStorage), доступна функция миграции данных в Supabase:

1. Войдите в приложение
2. Перейдите в раздел "Настройки"
3. Нажмите на кнопку "Перейти к миграции" в разделе "Миграция данных в облако"
4. На странице миграции нажмите "Начать миграцию"
5. После успешной миграции вы можете очистить локальные данные, нажав "Очистить локальные данные"

## Структура проекта

Основные файлы, связанные с аутентификацией Supabase:

- `src/utils/supabaseClient.ts` - инициализация клиента Supabase
- `src/context/UserContext.tsx` - контекст пользователя с функциями для регистрации, входа и выхода
- `src/utils/apiService.ts` - сервис для работы с данными пользователя (поддерживает как Supabase, так и localStorage)
- `src/utils/migrationScript.ts` - скрипт для миграции данных из localStorage в Supabase
- `src/pages/MigrationPage.tsx` - страница для миграции данных
- `src/pages/AuthPage.tsx` - страница аутентификации

## Преимущества использования Supabase

1. **Облачное хранение данных** - данные пользователей хранятся в облаке, что позволяет использовать приложение на разных устройствах
2. **Безопасность** - Supabase обеспечивает безопасное хранение паролей и данных пользователей
3. **Масштабируемость** - Supabase позволяет легко масштабировать приложение при увеличении количества пользователей
4. **Дополнительные функции** - Supabase предоставляет множество дополнительных функций, таких как хранение файлов, real-time подписки и т.д.

## Дальнейшие улучшения

В будущих версиях планируется добавить:
- Функцию сброса пароля
- Аутентификацию через социальные сети (Google, Facebook, и т.д.)
- Улучшенную систему управления профилем пользователя
- Расширенные возможности для хранения и синхронизации данных пользователя
